#include <stdio.h>
#include <openssl/des.h>
#include <string.h>

int main() {
    DES_cblock key = {0x13, 0x34, 0x57, 0x79, 0x9B, 0xBC, 0xDF, 0xF1}; // 64-bit key
    DES_key_schedule schedule;
    
    // Set the key schedule
    DES_set_key_unchecked(&key, &schedule);
    
    // Plaintext must be a multiple of 8 bytes (64 bits)
    unsigned char plaintext[] = "OpenAI12";  // 8 bytes
    unsigned char ciphertext[8], decryptedtext[8];
    
    // Encrypt
    DES_ecb_encrypt((DES_cblock *)plaintext, (DES_cblock *)ciphertext, &schedule, DES_ENCRYPT);
    
    // Decrypt
    DES_ecb_encrypt((DES_cblock *)ciphertext, (DES_cblock *)decryptedtext, &schedule, DES_DECRYPT);
    
    // Output
    printf("Plaintext:  %s\n", plaintext);
    printf("Encrypted:  ");
    for (int i = 0; i < 8; i++) 
        printf("%02X ", ciphertext[i]);
    printf("\nDecrypted:  %s\n", decryptedtext);
    
    return 0;
}
